#------------ mumu  ----------------------------------------------


v=246.22
Vud=0.97401
Vus=0.22650
Vub=3.61*10^(-3)
Vcd=-0.22636
Vcs=0.97320
Vcb=4053*10^(-3)
Vtd=8.54*10^(-3)
Vts=-39.78*10^(-3)
Vtb=0.999172
yd=2.6823*10^(-5)
ys=5.34164*10^(-4)
yb=0.02401
yu=1.24064*10^(-5)
yc=7.2945*10^(-3)
yt=0.99228

function params_mumu_SM()
    return [160364.14999999982, 144942.07000000027, 114843.30299999987, 112520.01600000013,
    90444.65999999993, 73394.56799999996, 61244.81000000001, 50469.25800000004, 41839.87200000001,
    32988.98099999998, 26921.08299999997, 21531.588000000014, 16912.700000000023, 13098.50849999998,
    10333.756999999998, 7769.335000000008, 6219.572799999999, 4759.304699999997, 3379.5842000000025,
    2662.3289999999997, 1926.3870599999996, 1417.9773300000013, 1048.4826799999985, 781.92225, 553.8864600000007,
    403.30310000000003, 292.1504179999998, 206.53567999999976, 148.22730000000007, 105.50032000000009,
    71.91374600000002, 49.58555399999998, 35.730599999999995, 22.943933999999985, 16.592136000000014,
    9.795759500000006, 6.265112599999987, 3.93946, 2.7555572000000037, 1.4354128499999987, 0.8566150000000007,
    0.5363705099999995, 0.2713831410000001, 0.13918220000000003, 0.110295, 0.030615200000000002, 0.00583208, 0.00094739]
end

SM_params_mumu=[160364.14999999982, 144942.07000000027, 114843.30299999987, 112520.01600000013,
    90444.65999999993, 73394.56799999996, 61244.81000000001, 50469.25800000004, 41839.87200000001,
    32988.98099999998, 26921.08299999997, 21531.588000000014, 16912.700000000023, 13098.50849999998,
    10333.756999999998, 7769.335000000008, 6219.572799999999, 4759.304699999997, 3379.5842000000025,
    2662.3289999999997, 1926.3870599999996, 1417.9773300000013, 1048.4826799999985, 781.92225, 553.8864600000007,
    403.30310000000003, 292.1504179999998, 206.53567999999976, 148.22730000000007, 105.50032000000009,
    71.91374600000002, 49.58555399999998, 35.730599999999995, 22.943933999999985, 16.592136000000014,
    9.795759500000006, 6.265112599999987, 3.93946, 2.7555572000000037, 1.4354128499999987, 0.8566150000000007,
    0.5363705099999995, 0.2713831410000001, 0.13918220000000003, 0.110295, 0.030615200000000002, 0.00583208, 0.00094739]

    function params_clq_d_2211_mumu()
        return [[3575.87, 151.649], [4102.66, 228.317], [4048.27, 316.779], [3988.14, 382.493],
        [3859.31, 465.058], [3842.13, 517.293], [3687.25, 666.771], [3549.73, 792.139], [3455.08, 916.578],
        [3172.75, 993.656], [3086.19, 1112.52], [2879.1, 1209.1], [2628.32, 1444.98], [2447.11, 1467.27],
        [2282.89, 1675.29], [2073.37, 1823.87], [1898.64, 1927.88], [1731.18, 2103.39], [1566.15, 2237.12],
        [1348.52, 2358.94], [1241.87, 2561.41], [1135.49, 2731.13], [1016.3, 2864.68], [894.646, 2998.22],
        [788.543, 3166.22], [681.077, 3214.47], [575.519, 3165.36], [504.329, 3294.59], [426.048, 3221.36],
        [355.676, 3226.53], [304.943, 3051.63], [244.664, 2952.55], [193.931, 2766.46], [161.2, 2576.92],
        [127.378, 2362.39], [100.648, 2147.0], [65.1892, 1765.33], [54.5516, 1552.52], [35.4585, 1261.32],
        [22.9117, 938.235], [15.2744, 740.077], [9.27377, 519.519], [5.45516, 369.608], [3.2731, 251.574],
        [2.45482, 240.374], [1.90931, 125.787], [0.545516, 45.6625], [0.0, 16.3696]]
    end

    function params_clq_d_2222_mumu()
        return [[862.414, 41.3861], [965.602, 64.7218], [1020.59, 90.6505], [962.59, 99.6258],
        [878.231, 123.66], [827.767, 133.433], [748.119, 165.269], [664.641, 181.476], [607.532, 198.459],
        [551.88, 205.349], [513.454, 225.243], [453.297, 232.619], [404.8, 243.488], [343.848, 260.083],
        [311.65, 274.931], [277.199, 275.319], [234.4, 278.23], [197.961, 290.749], [168.678, 291.526],
        [151.236, 294.426], [130.015, 296.704], [108.431, 309.082], [95.2095, 296.78], [76.3427, 299.438],
        [65.7169, 299.21], [56.3288, 284.857], [45.2804, 272.403], [36.345, 254.556], [26.2928, 240.811],
        [22.6704, 227.369], [17.4782, 207.169], [12.7691, 183.095], [9.93149, 160.389], [6.97318, 141.707],
        [6.03738, 124.848], [4.40729, 103.129], [3.10925, 91.2059], [1.78103, 70.246], [1.20748, 58.2472],
        [1.1471, 40.7806], [0.694299, 28.2503], [0.271682, 20.8839], [0.211308, 15.2643],
        [0.150935, 10.7078], [0.0, 8.73329], [0.0, 5.92345], [0.0, 2.43013], [0.0301869, 0.911299]]
    end

    function params_clq_d_2233_mumu()
        return [[233.595, 10.9837], [287.665, 16.9848], [310.432, 23.509], [304.503, 30.4461],
        [277.942, 36.282], [264.187, 41.5123], [246.588, 46.4017], [234.163, 52.771], [216.918, 56.1731],
        [196.009, 61.11], [171.717, 64.1796], [161.378, 68.17], [139.497, 69.7816], [120.35, 75.2812],
        [105.283, 77.5834], [90.8189, 79.1949], [76.8182, 82.3412], [66.8045, 81.7273], [55.5854, 81.318],
        [49.9038, 77.5597], [44.7788, 80.7072], [36.6754, 82.7449], [30.8452, 75.8131], [24.8256, 75.4129],
        [20.8582, 72.0288], [16.4697, 68.4629], [13.5862, 63.8599], [10.6396, 58.7293], [8.3138, 53.8351],
        [6.27218, 50.0145], [5.12509, 44.4472], [3.59914, 38.1158], [2.57833, 32.6577], [2.1679, 27.4179],
        [1.46281, 23.2152], [1.02081, 18.9396], [0.673523, 15.501], [0.431476, 11.3893], [0.326238, 7.82329],
        [0.157857, 6.40418], [0.0947142, 3.54777], [0.0315714, 2.78364], [0.0210476, 1.69201],
        [0.0105238, 1.05523], [0.052619, 0.509423], [0.0, 0.363874], [0.0, 0.109162], [0.0, 0.0545811]]
    end

    function params_clq_d_2212_mumu()
        return [[0.0, 182.305], [0.0, 273.812], [0.0, 378.796], [0.0, 447.604], [0.0, 519.958], [0.0, 621.396],
        [0.0, 644.043], [0.0, 767.109], [0.0, 852.571], [0.0, 937.349], [0.0, 1012.56], [0.0, 1136.31], [0.0, 1258.0],
        [0.0, 1346.88], [0.0, 1405.0], [0.0, 1497.3], [0.0, 1599.17], [0.0, 1722.92], [0.0, 1789.24], [0.0, 1955.98],
        [0.0, 2047.31], [0.0, 2123.62], [0.0, 2161.15], [0.0, 2224.96], [0.0, 2275.0], [0.0, 2273.12], [0.0, 2236.21],
        [0.0, 2246.85], [0.0, 2153.02], [0.0, 2081.71], [0.0, 2093.6], [0.0, 1952.86], [0.0, 1802.11], [0.0, 1620.71],
        [0.0, 1465.58], [0.0, 1308.58], [0.0, 1120.92], [0.0, 919.507], [0.0, 807.539], [0.0, 643.655], [0.0, 491.655],
        [0.0, 364.05], [0.0, 273.975], [0.0, 203.292], [0.0, 149.498], [0.0, 98.8313], [0.0, 38.7819], [0.0, 21.893]]
    end

    function params_clq_d_2213_mumu()
        return [[0.0, 96.5817], [0.0, 160.706], [0.0, 214.934], [0.0, 250.954], [0.0, 303.203], [0.0, 343.182],
        [0.0, 384.279], [0.0, 466.409], [0.0, 509.734], [0.0, 529.702], [0.0, 609.948], [0.0, 651.767], [0.0, 730.883],
        [0.0, 798.697], [0.0, 833.734], [0.0, 896.65], [0.0, 957.682], [0.0, 1005.53], [0.0, 969.362], [0.0, 1130.04],
        [0.0, 1150.67], [0.0, 1225.42], [0.0, 1247.41], [0.0, 1273.11], [0.0, 1282.58], [0.0, 1265.67], [0.0, 1232.86],
        [0.0, 1246.05], [0.0, 1181.45], [0.0, 1125.3], [0.0, 1075.92], [0.0, 996.436], [0.0, 896.996], [0.0, 841.525],
        [0.0, 735.996], [0.0, 649.747], [0.0, 529.674], [0.0, 457.292], [0.0, 361.572], [0.0, 288.852], [0.0, 195.161],
        [0.0, 139.014], [0.0, 108.911], [0.0, 74.4114], [0.0, 56.485], [0.0, 34.4998], [0.0, 9.13231], [0.0, 3.0441]]
    end

    function params_clq_d_2223_mumu()
        return [[0.0, 46.2439], [0.0, 75.6912], [0.0, 88.2355], [0.0, 113.962], [0.0, 134.692], [0.0, 151.382],
        [0.0, 173.302], [0.0, 188.616], [0.0, 204.124], [0.0, 223.218], [0.0, 231.65], [0.0, 253.168], [0.0, 258.014],
        [0.0, 264.023], [0.0, 281.276], [0.0, 299.013], [0.0, 297.075], [0.0, 286.316], [0.0, 314.521], [0.0, 333.761],
        [0.0, 340.426], [0.0, 337.294], [0.0, 334.403], [0.0, 316.414], [0.0, 309.508], [0.0, 297.622], [0.0, 288.146],
        [0.0, 265.419], [0.0, 250.963], [0.0, 232.492], [0.0, 194.506], [0.0, 190.491], [0.0, 157.966], [0.0, 137.407],
        [0.0, 108.496], [0.0, 99.5018], [0.0, 77.2565], [0.0, 59.1871], [0.0, 45.6954], [0.0, 35.4159], [0.0, 24.3334],
        [0.0, 18.0693], [0.0, 12.2068], [0.0, 5.8625], [0.0, 6.34435], [0.0, 2.89109], [0.0, 0.803082], [0.0, 0.321233]]
    end

    function params_cqe_d_1122_mumu()
        return [[1691.82, 159.025], [1850.93, 271.337], [1554.87, 345.88], [1587.09, 468.13],
        [1434.02, 509.874], [1297.06, 605.289], [1115.79, 635.426], [1060.26, 746.826], [955.378, 826.143],
        [866.794, 1023.1], [779.127, 1059.64], [689.855, 1244.12], [652.448, 1322.54], [587.96, 1429.49],
        [537.242, 1618.42], [487.901, 1648.72], [433.282, 1955.29], [385.777, 1982.03], [368.336, 2112.14],
        [302.437, 2293.73], [279.924, 2577.39], [254.177, 2657.59], [223.143, 2887.22], [195.219, 3008.78],
        [173.825, 3071.25], [153.178, 3089.83], [134.893, 3108.4], [114.806, 3134.57], [90.8618, 3194.51],
        [76.8065, 3120.22], [64.1816, 3029.89], [51.5568, 2862.73], [42.1658, 2651.68], [33.2725, 2509.85],
        [25.001, 2314.84], [20.2744, 1975.46], [15.9832, 1794.8], [10.4482, 1487.51], [7.21422, 1311.91],
        [4.22902, 919.35], [2.1767, 671.151], [1.92794, 536.076], [1.36821, 358.791], [0.435341, 249.043],
        [0.248766, 203.456], [0.621915, 121.567], [0.0, 54.0298], [0.0, 21.1054]]
    end

    function params_cqe_d_2222_mumu()
        return [[397.166, 46.3699], [431.946, 61.5777], [391.556, 77.252], [365.19, 95.3521],
        [315.264, 111.586], [284.411, 130.713], [235.745, 141.277], [213.295, 149.764], [186.287, 175.654],
        [158.853, 186.284], [140.62, 205.144], [121.11, 212.345], [106.413, 226.49], [90.7366, 225.547],
        [78.0846, 236.177], [66.029, 254.008], [55.8903, 253.151], [50.0968, 243.892], [39.6174, 263.095],
        [32.3715, 277.985], [27.8624, 288.974], [23.8513, 292.59], [19.7863, 283.87], [16.4348, 276.284],
        [14.2812, 279.687], [10.9498, 268.06], [9.16632, 251.683], [7.18769, 240.623], [5.9359, 224.813],
        [4.77833, 208.152], [3.75537, 189.365], [2.867, 171.853], [1.99882, 151.151], [1.72289, 140.588],
        [1.2316, 117.192], [0.827796, 100.177], [0.545134, 83.4452], [0.370152, 66.9972], [0.201901, 49.4857],
        [0.228822, 37.7878], [0.121141, 30.6273], [0.0201901, 18.1495], [0.0403803, 14.5338],
        [0.0336502, 9.07475], [0.00673005, 9.14565], [0.0134601, 4.25379], [0.0134601, 2.41048], [0.0, 0.992551]]
    end

    function params_cqe_d_3322_mumu()
        return [[110.016, 10.7059], [120.532, 15.7454], [111.633, 22.3395], [97.5579, 28.1312], [99.1757, 32.3183],
        [82.3498, 36.6558], [75.1649, 42.179], [65.7759, 48.855], [57.3431, 49.9165], [50.4375, 53.6438],
        [43.7842, 59.6828], [37.9277, 62.3013], [32.1377, 68.1988], [27.5428, 69.2368], [24.236, 69.284],
        [20.106, 74.6861], [17.9147, 74.3794], [14.6213, 73.9076], [12.4035, 74.3794], [9.83815, 72.0315],
        [8.19674, 70.7829], [7.10728, 70.8477], [5.78423, 70.3288], [4.71752, 67.8802], [3.9919, 61.2478],
        [3.0637, 61.7343], [2.47453, 56.5452], [1.88742, 52.7182], [1.52358, 48.1453], [1.23623, 43.3129],
        [0.880658, 38.6914], [0.717344, 32.6752], [0.54576, 29.3834], [0.3411, 26.0267], [0.252207, 20.9349],
        [0.173651, 16.3295], [0.132305, 13.362], [0.06822, 11.0593], [0.0516818, 7.7026], [0.0372109, 4.92967],
        [0.0186055, 3.66482], [0.0103364, 2.51348], [0.0103364, 1.41079], [0.00206727, 0.794584], [0.0, 0.56756],
        [0.0, 0.356752], [0.0, 0.145944], [0.0, 0.016216]]
    end

    function params_cqe_d_1222_mumu()
        return [[0.0, 169.013], [0.0, 270.992], [0.0, 343.732], [0.0, 464.252], [0.0, 494.917],
        [0.0, 656.086], [0.0, 676.21], [0.0, 751.573], [0.0, 842.693], [0.0, 937.239],
        [0.0, 1018.08], [0.0, 1171.55], [0.0, 1211.97], [0.0, 1335.29], [0.0, 1467.52],
        [0.0, 1573.71], [0.0, 1640.17], [0.0, 1708.68], [0.0, 1755.27], [0.0, 1914.84],
        [0.0, 2028.24], [0.0, 2084.32], [0.0, 2148.94], [0.0, 2230.63], [0.0, 2200.76],
        [0.0, 2206.25], [0.0, 2216.61], [0.0, 2198.93], [0.0, 2164.79], [0.0, 2064.81],
        [0.0, 2019.09], [0.0, 1904.48], [0.0, 1733.79], [0.0, 1602.11], [0.0, 1469.21],
        [0.0, 1330.21], [0.0, 1086.36], [0.0, 981.503], [0.0, 806.539], [0.0, 612.677],
        [0.0, 478.559], [0.0, 328.59], [0.0, 237.755], [0.0, 182.889], [0.0, 168.867],
        [0.0, 102.418], [0.0, 33.5296], [0.0, 14.6311]]
    end

    function params_cqe_d_1322_mumu()
        return [[0.0, 104.97], [0.0, 166.619], [0.0, 219.937], [0.0, 272.005], [0.0, 296.165],
        [0.0, 363.645], [0.0, 405.513], [0.0, 460.935], [0.0, 531.577], [0.0, 567.094],
        [0.0, 654.909], [0.0, 684.572], [0.0, 754.044], [0.0, 808.294], [0.0, 869.96],
        [0.0, 914.453], [0.0, 930.846], [0.0, 1042.47], [0.0, 1054.96], [0.0, 1126.32],
        [0.0, 1172.6], [0.0, 1232.28], [0.0, 1250.39], [0.0, 1260.45], [0.0, 1263.13],
        [0.0, 1251.06], [0.0, 1268.5], [0.0, 1222.22], [0.0, 1152.81], [0.0, 1117.27],
        [0.0, 1053.22], [0.0, 995.551], [0.0, 864.442], [0.0, 794.026], [0.0, 764.183],
        [0.0, 632.404], [0.0, 539.522], [0.0, 424.174], [0.0, 357.446], [0.0, 266.24],
        [0.0, 192.136], [0.0, 141.838], [0.0, 94.5589], [0.0, 73.7693], [0.0, 60.0214],
        [0.0, 31.8549], [0.0, 13.4126], [0.0, 4.3591]]
    end

    function params_cqe_d_2322_mumu()
        return [[0.0, 46.1021], [0.0, 67.7252], [0.0, 86.7985], [0.0, 109.442], [0.0, 128.005],
        [0.0, 141.264], [0.0, 173.631], [0.0, 196.896], [0.0, 222.702], [0.0, 228.697],
        [0.0, 242.717], [0.0, 260.395], [0.0, 276.041], [0.0, 294.735], [0.0, 304.285],
        [0.0, 311.499], [0.0, 315.664], [0.0, 306.927], [0.0, 320.236], [0.0, 345.025],
        [0.0, 341.979], [0.0, 353.999], [0.0, 340.415], [0.0, 341.485], [0.0, 317.611],
        [0.0, 313.248], [0.0, 291.431], [0.0, 272.497], [0.0, 252.08], [0.0, 227.135],
        [0.0, 206.06], [0.0, 182.762], [0.0, 162.922], [0.0, 134.355], [0.0, 116.82],
        [0.0, 100.272], [0.0, 82.7369], [0.0, 63.2258], [0.0, 50.877], [0.0, 35.9761],
        [0.0, 25.1915], [0.0, 15.5595], [0.0, 12.4311], [0.0, 7.1623], [0.0, 6.58602],
        [0.0, 2.55208], [0.0, 0.823252], [0.0, 0.411626]]
    end


function events_mumu(params, i)
    #TODO: clq_22 = params.Clq[1]
    #TODO: cqe_22 = params.Cqe[1]
    
    clq_22 = params.Clq1
    cqe_22 = params.Cqe

    SM_mu = params_mumu_SM()
    plq_2211 = params_clq_d_2211_mumu()
    clq_2211=plq_2211[i]
    plq_2212 = params_clq_d_2212_mumu()
    clq_2212=plq_2212[i]
    plq_2222 = params_clq_d_2222_mumu()
    clq_2222=plq_2222[i]
    plq_2223 = params_clq_d_2223_mumu()
    clq_2223=plq_2223[i]
    plq_2213 = params_clq_d_2213_mumu()
    clq_2213=plq_2213[i]
    plq_2233 = params_clq_d_2233_mumu()
    clq_2233=plq_2233[i]
    pqe_2211 = params_cqe_d_1122_mumu()
    cqe_2211=pqe_2211[i]
    pqe_2212 = params_cqe_d_1222_mumu()
    cqe_2212=pqe_2212[i]
    pqe_2222 = params_cqe_d_2222_mumu()
    cqe_2222=pqe_2222[i]
    pqe_2223 = params_cqe_d_2322_mumu()
    cqe_2223=pqe_2223[i]
    pqe_2213 = params_cqe_d_1322_mumu()
    cqe_2213=pqe_2213[i]
    pqe_2233 = params_cqe_d_3322_mumu()
    cqe_2233=pqe_2233[i]


    events = (SM_mu[i] +
    clq_22*(clq_2211[1]*Vtd*Vtd+clq_2222[1]*Vts*Vts+clq_2233[1]*Vtb*Vtb) +
    clq_22*clq_22*(clq_2211[2]*Vtd*Vtd*Vtd*Vtd+clq_2212[2]*Vtd*Vts*Vtd*Vts+ clq_2213[2]*Vtd*Vtb*Vtd*Vtb+ clq_2222[2]*Vts*Vts*Vts*Vts+ clq_2223[2]*Vts*Vtb*Vts*Vtb+ clq_2233[2]*Vtb*Vtb*Vtb*Vtb) +
    cqe_22*(cqe_2211[1]*Vtd*Vtd+cqe_2222[1]*Vts*Vts+cqe_2233[1]*Vtb*Vtb) +
    cqe_22*cqe_22*(cqe_2211[2]*Vtd*Vtd*Vtd*Vtd+cqe_2212[2]*Vtd*Vts*Vtd*Vts+ cqe_2213[2]*Vtd*Vtb*Vtd*Vtb+ cqe_2222[2]*Vts*Vts*Vts*Vts+ cqe_2223[2]*Vts*Vtb*Vts*Vtb+ cqe_2233[2]*Vtb*Vtb*Vtb*Vtb))

    return events
end

num_mu=size(SM_params_mumu);

mumu_dist=Function[]
for i in 1:num_mu[1]
    @eval begin
        function $(Symbol("events_mumu_bin$i"))(params)
            return events_mumu(params, $i)
        end
        push!(mumu_dist, $(Symbol("events_mumu_bin$i")))
    end
end
